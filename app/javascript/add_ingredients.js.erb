document.addEventListener('DOMContentLoaded', function () {
    let ingredientIndex = 1;  // Start with 1, since you've already initialized one field in the form

    // Add new ingredient field
    document.getElementById('add-ingredient').addEventListener('click', function (e) {
        e.preventDefault();

        const ingredientContainer = document.getElementById('ingredients');
        const newIngredient = document.createElement('div');
        newIngredient.classList.add('ingredient-fields');
        
        newIngredient.innerHTML = `
            <div class="form-group">
                <label for="recipe_recipe_ingredients_attributes_${ingredientIndex}_ingredient_id">Select Ingredient</label>
                <select name="recipe[recipe_ingredients_attributes][${ingredientIndex}][ingredient_id]" id="recipe_recipe_ingredients_attributes_${ingredientIndex}_ingredient_id" class="form-control">
                    <option value="">Select an Ingredient</option>
                    <% Ingredient.all.each do |ingredient| %>
                        <option value="<%= ingredient.id %>"><%= ingredient.name %></option>
                    <% end %>
                </select>
            </div>
            <div class="form-group">
                <label for="recipe_recipe_ingredients_attributes_${ingredientIndex}_quantity">Quantity</label>
                <input type="number" name="recipe[recipe_ingredients_attributes][${ingredientIndex}][quantity]" id="recipe_recipe_ingredients_attributes_${ingredientIndex}_quantity" class="form-control">
            </div>
        `;

        ingredientContainer.appendChild(newIngredient);
        ingredientIndex++;  // Increment the index for the next ingredient
    });
});
